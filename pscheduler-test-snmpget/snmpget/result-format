#!/usr/bin/python
#
# Format a result
#

import jsontemplate
import pscheduler
import sys

from validate import result_is_valid


try:
   format = sys.argv[1]
except IndexError:
   format = 'text/plain'

input = pscheduler.json_load(exit_on_error=True)

valid, message = result_is_valid(input["result"])

if not valid:
    pscheduler.fail(message)

json = input["result"]

if format == 'text/plain':
   print 'Time ......... %s' % json['time']
   print 'Data.......... %s' % json['data']
   
elif format == 'text/html':
   print '<table>'
   print '  <tr>'
   print '    <th>Time</th>'
   print '  </tr>'
   print '  <tr>'
   print '    <td>%s</td>' % json['time']
   print '  </tr>'
   print '  <tr>'
   print '    <th>SNMP Data</th>'
   print '    <td>%s</td>' % json['data']
   print '  </tr>'



else:
   pscheduler.fail("Unsupported format '%s'" % format)
